# ğŸ§  Clase 3: Integrando Modelos y Mostrando Datos en HTML â€“ AplicaciÃ³n Web con Django

En esta tercera clase del curso de Django, continuarÃ¡s construyendo sobre la base de tu proyecto django_project y tu aplicaciÃ³n post. Esta vez, el enfoque serÃ¡ en la integraciÃ³n de modelos para manejar y almacenar datos, y cÃ³mo mostrar esos datos dinÃ¡micamente en tus plantillas HTML.

La app sigue siendo â€œInicio del Cursoâ€, pero ahora es mÃ¡s potente. AprenderÃ¡s a definir la estructura de tus datos con modelos, a guardar informaciÃ³n en tu base de datos y a recuperarla para presentarla al usuario. Â¡Este es un paso crucial para crear aplicaciones web interactivas y con contenido dinÃ¡mico!

---

## ğŸ¯ Objetivos de la Clase

- Crear un entorno virtual y un proyecto Django (repaso).
- Crear la app post dentro del proyecto (repaso).
- Configurar el entorno para usar plantillas HTML (repaso).
- Renderizar la vista home.html usando TemplateView (repaso).
- Crear un modelo simple en Django para almacenar informaciÃ³n.
- Realizar migraciones para aplicar el modelo a la base de datos.
- Mostrar datos del modelo en la plantilla HTML usando el contexto de la vista.
- Visualizar la pÃ¡gina en el navegador mediante configuraciÃ³n en urls.py.

---

## ğŸ› ï¸ Lo Que AprenderÃ¡s

- CÃ³mo iniciar un proyecto Django desde cero.
- CÃ³mo estructurar una app Django y vincularla al proyecto.
- CÃ³mo configurar la carpeta templates para usar archivos HTML.
- CÃ³mo definir rutas y vistas usando clases.
- CÃ³mo definir modelos en Django para representar y organizar tus datos.
- CÃ³mo usar el ORM (Object-Relational Mapper) de Django para interactuar con la base de datos sin SQL directo.
- CÃ³mo pasar datos de un modelo (o cualquier otro dato) desde la vista a una plantilla HTML.

---

## ğŸš€ GuÃ­a Paso a Paso

### ğŸ”§ 1. Requisitos Previos

AsegÃºrate de tener instalado:

- âœ… Python 3.10 o superior
- âœ… pip (gestor de paquetes de Python)
- âœ… virtualenv *(opcional pero recomendado)*

---

### ğŸ 2. Crear y Activar un Entorno Virtual

```bash
python -m venv env

# Activar el entorno:
source env/bin/activate     # En Linux/macOS
env\Scripts\activate        # En Windows
```

---

### ğŸ“¦ 3. Instalar Django
```bash
pip install django  # Descarga django
```

---

### ğŸ“ 4. Crear el Proyecto Django
```bash
django-admin startproject django_project .  # Esto genera la carpeta django_project/ dentro de tu proyecto
```

#### ğŸ”¸ Nota: No olvides el espacio y el punto (.) al final para instalar el proyecto en la carpeta actual.

---

### ğŸ—ï¸ 5. Crear la App Django
```bash
python manage.py startapp post  # Esto generarÃ¡ la carpeta post/ dentro de tu proyecto.
```  

---

### âš™ï¸ 6. Registrar la App en el proyecto

#### 1. Settings.py
Edita django_project/settings.py y agrega 'post' en INSTALLED_APPS:

INSTALLED_APPS = [
    ...
    'post',
]

#### 2. urls.py
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('post.urls'))  # La raÃ­z del sitio web delega sus URLs a la app post
]

---

### ğŸ’¾ 7. Crear el Modelo en models.py
En post/models.py, define un modelo simple para almacenar un mensaje de bienvenida. Este modelo tendrÃ¡ un campo para el contenido del mensaje y otro para la fecha de creaciÃ³n:

from django.db import models

class Post(models.Model):
    title = models.TextField(max_length=200)
    description = models.TextField()

    def __str__(self):
        return self.title
---

### ğŸ“¤ 8. Realizar Migraciones
DespuÃ©s de crear o modificar modelos, siempre debes indicarle a Django que cree o actualice las tablas correspondientes en tu base de datos.
```bash
python manage.py makemigrations # Crea los archivos de migraciÃ³n (plan de cambios)
python manage.py migrate        # Aplica los cambios a la base de datos (ejecuta el plan)
```

---

### ğŸ“ 9. Crear la Carpeta de Templates con base.html, home.html, detail.html
Crea una carpeta llamada templates y dentro de ella el archivo home.html. Modificaremos home.html para que pueda mostrar el contenido de nuestro modelo dinÃ¡micamente:
<!-- templates/home.html -->
{% extends 'base.html' %}

{% block content %}

  {% if user.is_authenticated %}
    <a href="{% url 'create' %}">Crear nueva publicaciÃ³n</a>
  {% endif %}

  <ul>
    {% for post in object_list %}
      <li>
        <a href="{% url 'detail' post.pk %}">{{ post.title }}</a>

        {% if user.is_authenticated and post.author == user %}
          | <a href="{% url 'edit' post.pk %}">Editar</a>
          | <a href="{% url 'delete' post.pk %}">Eliminar</a>
        {% endif %}
      </li>
    {% endfor %}
  </ul>

{% endblock %}

<!-- templates/base.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Bienvenido{% if user.is_authenticated %}, {{ user.username }}{% endif %}</h1>

    <nav>
    <ul>
        {% if user.is_authenticated %}
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit">Cerrar sesiÃ³n</button>
            </form>
        {% else %}
            <li><form method="post" action="{% url 'login' %}">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit">Iniciar sesiÃ³n</button>
            </form></li>

            <li><a href="{% url 'signup' %}">Registrarse</a></li>
        {% endif %}
    </ul>
    </nav>

    <p>Este es un ejemplo bÃ¡sico para mostrar cÃ³mo navegar entre vistas de autenticaciÃ³n.</p>


    {% block content %}

    {% endblock %}

<!-- templates/detail.html -->
{% extends 'base.html' %}

{% block content %}
    <h2>Detail</h2>
    <!-- TÃ­tulo del post -->
    <h1>{{ post.title }}</h1>
    
    <!-- DescripciÃ³n completa -->
        <p>{{ post.description }}</p>
    
    <!-- Imagen (si existe) -->
  {% if object.image %}
    <img src="{{ object.image.url }}" alt="Imagen del post">
  {% endif %}

  {% if user.is_authenticated and object.author == user %}
    <a href="{% url 'edit' object.pk %}">Editar</a>
    <a href="{% url 'delete' object.pk %}">Eliminar</a>
  {% endif %}
{% endblock %}

---

### ğŸ§­ 10. Configurar settings.py para Templates
En el bloque TEMPLATES de django_project/settings.py, ajusta la clave DIRS para que Django sepa dÃ³nde buscar tus plantillas:

TEMPLATES = [
    {
        'DIRS': [BASE_DIR / 'templates'], # Asegura que Django encuentre tu carpeta 'templates'
        ...
    },
]

---

### ğŸ‘ï¸ 11. Crear la Vista en views.py
En post/views.py, modificaremos la vista HomeView para que no solo renderice la plantilla, sino que tambiÃ©n obtenga el mensaje de bienvenida de nuestro modelo y lo pase a la plantilla a travÃ©s del contexto:

from django.shortcuts import render
from django.views.generic import ListView

from .models import Post

class PostListView(ListView):
    template_name = "home.html"
    model = Post

---

### ğŸ›£ï¸ 12. Configurar Rutas en urls.py
Edita django_project/urls.py para que la URL raÃ­z (la ruta vacÃ­a '') apunte a nuestra HomeView:

from django.contrib import admin
from django.urls import path
from post.views import HomeView # Importa tu vista

urlpatterns = [
    path('admin/', admin.site.urls), # Ruta para el panel de administraciÃ³n
    path('', HomeView.as_view(), name='home'), # Ruta para la pÃ¡gina de inicio
]

---

### â• 13. Agregar un Mensaje de Bienvenida (Â¡Para ver el modelo en acciÃ³n!)
Para que el mensaje aparezca en tu home.html, necesitas aÃ±adir un registro en tu modelo Post. Tienes dos formas principales de hacerlo:

Usando el Panel de AdministraciÃ³n de Django (Recomendado para manejar datos):
#### 1. Crea un superusuario para acceder al panel de administraciÃ³n (si no lo has hecho ya):

```bash
python manage.py createsuperuser
```
Sigue las instrucciones en pantalla para definir tu usuario y contraseÃ±a.

#### 2. Registra tu modelo en post/admin.py para que sea visible en el panel:

from django.contrib import admin
from .models import Post

admin.site.register(Post)

#### 3. Levanta el servidor de desarrollo:

```bash
python manage.py runserver
```

#### 4. Abre tu navegador y navega a: http://127.0.0.1:8000/admin/.

#### 5. Inicia sesiÃ³n con las credenciales del superusuario que creaste.

#### 6. DeberÃ­as ver una secciÃ³n para "post" y dentro de ella, "Mensajes de bienvenida". Haz clic en "Mensajes de bienvenida" y luego en "AÃ±adir mensaje de bienvenida" para crear tu primer registro.
---

### ğŸš¦ 14. Levantar el Servidor y Verificar
```bash
python manage.py runserver  # Esto levanta el servidor de desarrollo
```

---

### ğŸ—ï¸ 15. Crear la App authentication
```bash
python manage.py startapp authentication   # Esto generarÃ¡ la carpeta authentication/ dentro de tu proyecto.
```  

---

### âš™ï¸ 16. Registrar la App en settings.py
Edita django_project/settings.py y agrega 'post' y 'authentication' en INSTALLED_APPS:
INSTALLED_APPS = [
    ...
    'post',
    'authentication'
]

---

### ğŸ—‚ï¸ 17. Modifica la Carpeta de Templates, crea la subcarpeta registration que contenga los archivos login.html y signup.html
<!-- templates/registration/signup.html -->
<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Iniciar sesiÃ³n</button>
</form>

<!-- templates/registration/signup.html -->
<h2>Iniciar sesiÃ³n</h2>
<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Entrar</button>
</form>

---

### ğŸ‘ï¸ 18. Crear la Vista en views.py
En authentication/views.py:
from django.contrib.auth.forms import UserCreationForm
from django.urls import reverse_lazy
from django.views.generic.edit import CreateView

class SignUpView(CreateView):
    form_class = UserCreationForm
    success_url = reverse_lazy('login')
    template_name = 'registration/signup.html'

---

### ğŸ›£ï¸ 19. Configurar Rutas en urls.py
<!-- Edita django_project/urls.py: -->
from django.contrib import admin
from django.urls import path, include  

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('post.urls')),  
    path('accounts/', include('authentication.urls')) 
]

<!-- Edita authentication/urls.py -->
from django.contrib import admin
from django.urls import path, include
from .views import SignUpView

urlpatterns = [
    path('', include('django.contrib.auth.urls')),  # Â¡Esta lÃ­nea es crucial!
    path('signup/', SignUpView.as_view(), name='signup'),
]

---

### ğŸš¦ 20. Levantar el Servidor
```bash
python manage.py runserver  # Esto levanta el servidor
```

Abre tu navegador en:  http://127.0.0.1:8000/  

---

âœ… Â¡Listo!